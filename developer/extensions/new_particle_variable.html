<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Source Themes Academic 4.8.0"><meta name=description content="Sometimes you may wish to output a new variable associated with a particle. Such extensions may be specific to a particular task, and may be too niche to be added to the core EPOCH code."><link rel=alternate hreflang=en-us href=/developer/extensions/new_particle_variable.html><meta name=theme-color content="#3f51b5"><script src=/js/mathjax-config.js></script><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0-1/css/all.min.css integrity="sha256-4w9DunooKSr3MFXHXWyFER38WmPdm361bQS/2KUWZbU=" crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/github.min.css crossorigin=anonymous title=hl-light><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/dracula.min.css crossorigin=anonymous title=hl-dark disabled><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.css integrity="sha256-SHMGCYmST46SoyGgo4YR/9AlK1vf3ff84Aq9yK4hdqM=" crossorigin=anonymous><script src=https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.1.2/lazysizes.min.js integrity="sha256-Md1qLToewPeKjfAHU1zyPwOutccPAm5tahnaw7Osw0A=" crossorigin=anonymous async></script><script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js integrity crossorigin=anonymous async></script><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Montserrat:400,700%7CRoboto:400,400italic,700%7CRoboto+Mono&display=swap"><link rel=stylesheet href=/css/academic.css><link rel=manifest href=/index.webmanifest><link rel=icon type=image/png href=/images/icon_hucf2a1ead28adac6bbe3177e5d4e4a1f0_753_32x32_fill_lanczos_center_2.png><link rel=apple-touch-icon type=image/png href=/images/icon_hucf2a1ead28adac6bbe3177e5d4e4a1f0_753_192x192_fill_lanczos_center_2.png><link rel=canonical href=/developer/extensions/new_particle_variable.html><meta property="twitter:card" content="summary"><meta property="og:site_name" content="EPOCH"><meta property="og:url" content="/developer/extensions/new_particle_variable.html"><meta property="og:title" content="New Particle Variable | EPOCH"><meta property="og:description" content="Sometimes you may wish to output a new variable associated with a particle. Such extensions may be specific to a particular task, and may be too niche to be added to the core EPOCH code."><meta property="og:image" content="/images/logo_hub4b4d6a0f57638acebb5550a80c8c030_9243_300x300_fit_lanczos_2.png"><meta property="twitter:image" content="/images/logo_hub4b4d6a0f57638acebb5550a80c8c030_9243_300x300_fit_lanczos_2.png"><meta property="og:locale" content="en-us"><meta property="article:modified_time" content="2023-04-24T17:05:26+01:00"><title>New Particle Variable | EPOCH</title></head><body id=top data-spy=scroll data-offset=70 data-target=#TableOfContents><aside class=search-results id=search><div class=container><section class=search-header><div class="row no-gutters justify-content-between mb-3"><div class=col-6><h1>Search</h1></div><div class="col-6 col-search-close"><a class=js-search href=#><i class="fas fa-times-circle text-muted" aria-hidden=true></i></a></div></div><div id=search-box><input name=q id=search-query placeholder=Search... autocapitalize=off autocomplete=off autocorrect=off spellcheck=false type=search></div></section><section class=section-search-results><div id=search-hits></div></section></div></aside><nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id=navbar-main><div class=container><div class="d-none d-lg-inline-flex"><a class=navbar-brand href=/><img src=/images/logo_hub4b4d6a0f57638acebb5550a80c8c030_9243_0x70_resize_lanczos_2.png alt=EPOCH></a></div><button type=button class=navbar-toggler data-toggle=collapse data-target=#navbar-content aria-controls=navbar aria-expanded=false aria-label="Toggle navigation">
<span><i class="fas fa-bars"></i></span></button><div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none"><a class=navbar-brand href=/><img src=/images/logo_hub4b4d6a0f57638acebb5550a80c8c030_9243_0x70_resize_lanczos_2.png alt=EPOCH></a></div><div class="navbar-collapse main-menu-item collapse justify-content-end" id=navbar-content><ul class="navbar-nav d-md-inline-flex"><li class=nav-item><a class=nav-link href=/#about><span>Home</span></a></li><li class=nav-item><a class=nav-link href=/quickstart.html><span>Quick Start</span></a></li><li class=nav-item><a class=nav-link href=/documentation.html><span>User Guide</span></a></li><li class=nav-item><a class=nav-link href=/developer.html><span>Dev Guide</span></a></li><li class=nav-item><a class=nav-link href=/publication.html><span>Publications</span></a></li><li class=nav-item><a class=nav-link href=/license.html><span>License</span></a></li><li class=nav-item><a class=nav-link href=/contact.html><span>Contact</span></a></li></ul></div><ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2"><li class=nav-item><a class="nav-link js-search" href=#><i class="fas fa-search" aria-hidden=true></i></a></li></ul></div></nav><div class="container-fluid docs"><div class="row flex-xl-nowrap"><div class="col-12 col-md-3 col-xl-2 docs-sidebar"><form class="docs-search d-flex align-items-center"><button class="btn docs-toggle d-md-none p-0 mr-3" type=button data-toggle=collapse data-target=#docs-nav aria-controls=docs-nav aria-expanded=false aria-label="Toggle section navigation">
<span><i class="fas fa-bars"></i></span></button>
<input name=q type=search class=form-control placeholder=Search... autocomplete=off></form><nav class="collapse docs-links" id=docs-nav><div class=docs-toc-item><a class=docs-toc-link href=/developer.html>Overview</a><ul class="nav docs-sidenav"><li><a href=/developer/source_code_files.html>Source code files</a></li><li><a href=/developer/makefile.html>Makefile</a></li></ul></div><div class=docs-toc-item><a class=docs-toc-link href=/developer/core_structure.html>Core Structure</a><ul class="nav docs-sidenav"><li><a href=/developer/core_structure/basic_structures.html>Basic Structures</a></li><li><a href=/developer/core_structure/macro_particles.html>Particles</a></li><li><a href=/developer/core_structure/linked_lists.html>Linked Lists</a></li><li><a href=/developer/core_structure/partlist.html>Partlist</a></li><li><a href=/developer/core_structure/field_solver.html>Field Solver</a></li><li><a href=/developer/core_structure/particle_pusher.html>Particle Pusher</a></li><li><a href=/developer/core_structure/shape_functions.html>Weighting Functions</a></li><li><a href=/developer/core_structure/current_solver.html>Current solver</a></li><li><a href=/developer/core_structure/boundary_conditions.html>Boundary Conditions</a></li><li><a href=/developer/core_structure/parallelism.html>Parallelism</a></li><li><a href=/developer/core_structure/precompiler_flags.html>Pre-compilation Flags</a></li></ul></div><div class=docs-toc-item><a class=docs-toc-link href=/developer/input_output.html>Input Output</a><ul class="nav docs-sidenav"><li><a href=/developer/input_output/basic_output.html>Basic Output</a></li><li><a href=/developer/input_output/string_handling.html>String Handling</a></li><li><a href=/developer/input_output/error_codes.html>Error Codes</a></li><li><a href=/developer/input_output/adding_outputs.html>Adding Outputs</a></li><li><a href=/developer/input_output/custom_maths_parser.html>Custom Maths Parser</a></li><li><a href=/developer/input_output/custom_deck.html>Custom Deck</a></li></ul></div><div class=docs-toc-item><a class=docs-toc-link href=/developer/extensions.html>Extending EPOCH</a><ul class="nav docs-sidenav"><li><a href=/developer/extensions/input_deck.html>Input Deck</a></li><li><a href=/developer/extensions/maths_parser.html>Maths Parser</a></li><li><a href=/developer/extensions/new_modules.html>New Module</a></li><li class=active><a href=/developer/extensions/new_particle_variable.html>New Particle Variable</a></li></ul></div></nav></div><div class="d-none d-xl-block col-xl-2 docs-toc"><ul class="nav toc-top"><li><a href=# id=back_to_top class=docs-toc-title>Contents</a></li></ul><nav id=TableOfContents><ul><li><a href=#makefile>Makefile</a></li><li><a href=#constantsf90>Constants.F90</a></li><li><a href=#shared_dataf90>Shared_data.F90</a></li><li><a href=#welcomef90>Welcome.F90</a></li><li><a href=#partlistf90>Partlist.F90</a></li><li><a href=#deck_io_blockf90>Deck_io_block.F90</a></li><li><a href=#diagnosticsf90>Diagnostics.F90</a></li><li><a href=#iteratorsf90>Iterators.F90</a></li><li><a href=#setting-your-variable>Setting your variable</a></li><li><a href=#testing>Testing</a></li></ul></nav></div><main class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 docs-content" role=main><article class=article><div class=docs-article-container><h1>New Particle Variable</h1><div class=article-style><p>Sometimes you may wish to output a new variable associated with a
particle. Such extensions may be specific to a
particular task, and may be too niche to be added to the core EPOCH code.
Alternatively, users may wish to quickly add new particle variables, without
submitting a request to the developers and waiting for a new release. This
section will detail how to define a new particle variable, and how to dump it
to SDF files.</p><p>There are multiple parts of the code which need to be modified to create and print
a new particle variable, these are:</p><ul><li><code>Makefile</code>: New pre-compiler option to deactivate new variable when not needed (for speed)</li><li><code>shared_data.F90</code>: Give the particle datatype a new variable</li><li><code>housekeeping/welcome.F90</code>: Alert the user when the code is compiled with your new option</li><li><code>housekeeping/partlist.F90</code>: As particles move between MPI ranks, move your new variable with them</li><li><code>constants.F90</code>: Create tags for the new output and compiler flag</li><li><code>deck/deck_io_block.F90</code>: Lets the output block see the new output variable</li><li><code>io/diagnostics.F90</code>: Writes the new variable to the SDF file</li><li><code>io/iterators.F90</code>: Gives diagnostics.F90 variables to write to file</li><li><strong>Extra</strong>: The user should set the value of the new variable to something</li></ul><p>On this page, we provide an example of how to add and output a new particle
variable, which has actually been requested by an EPOCH user.
When electrons emit photons in the QED package, the photon macro-particle
contains no information about the electron which generated it. In this
example, let us output the Lorentz $\gamma$ factor of the radiating electron
for each emitted photon, at the time of photon emission. We will use EPOCH2D,
although this methodology would work for any dimension of the code. In these
examples, we will include some of the neighbouring lines of code, so you can
get a sense of where to insert the new code for your variable.</p><h2 id=makefile>Makefile</h2><p>We want a new pre-compiler flag for the new addition. As macro-particles move
around the simulation, they are passed between MPI ranks. The more particle
variables to transfer, the slower the code runs. Hence, if we don&rsquo;t need to use
the new particle variables, the code should be compiled without them. This
is achieved with new pre-compiler variables.</p><p>In the Makefile, there is a section with multiple commented-out pre-compiler
flags. Let us add a new one called &ldquo;extended_io&rdquo;. To do this, insert a line
such that the Makefile reads like:</p><pre><code># Use second order particle weighting (default is third order).
#DEFINES += $(D)PARTICLE_SHAPE_TOPHAT

# Use fifth order particle weighting (default is third order).
#DEFINES += $(D)PARTICLE_SHAPE_BSPLINE3

# Include a unique global particle ID. The first flag defines the ID using
# an 8-byte integer, the second uses 4-bytes.
#DEFINES += $(D)PARTICLE_ID
#DEFINES += $(D)PARTICLE_ID4

# Include QED routines
DEFINES += $(D)PHOTONS

# Extended I/O for QED routines
DEFINES += $(D)EXTENDED_IO

# Use the Trident process for pair production
#DEFINES += $(D)TRIDENT_PHOTONS

# Include bremsstrahlung routines
#DEFINES += $(D)BREMSSTRAHLUNG
</code></pre><p>Note that we have un-commented the new extended_io flag, and the photons flag,
as we will have to run the code with both for the new output in this example.</p><h2 id=constantsf90>Constants.F90</h2><p>Let us make new global integer flags for both the pre-compiler flag, and the
new output.</p><p>For the <code>EXTENDED_IO</code> pre-compiler flag, find the <code>c_def...</code> list and append a
new <code>c_def_extended_io</code> variable to the end:</p><pre><code>  INTEGER(i8), PARAMETER :: c_def_use_mpi3 = 2**25
  INTEGER(i8), PARAMETER :: c_def_bremsstrahlung = 2**26
  INTEGER(i8), PARAMETER :: c_def_probe_time = 2**27
  INTEGER(i8), PARAMETER :: c_def_extended_io = 2**28  ! New line
</code></pre><p>Next, let us make a new output flag: <code>c_dump_qed_el_gamma</code>. Find the list of
<code>c_dump...</code> parameters, and add our new one to the end. Remember to update the
<code>num_vars_to_dump</code> variable with the new number of dump flags.</p><pre><code>  INTEGER, PARAMETER :: c_dump_probe_time        = 72
  INTEGER, PARAMETER :: c_dump_cou_log           = 73
  INTEGER, PARAMETER :: c_dump_qed_el_gamma      = 74 ! New line
  INTEGER, PARAMETER :: num_vars_to_dump         = 74 ! Modified line
</code></pre><p>Note, you may wish to introduce multiple outputs with one pre-compiler flag.
For example, the <code>WORK_DONE_INTEGRATED</code> pre-compiler flag introduces <em>six</em> new
outputs.</p><h2 id=shared_dataf90>Shared_data.F90</h2><p>Here we declare a new variable for the particle data-type. Be sure to wrap this
inside your new pre-compiler flag using <code>#ifdef</code> commands (note these cannot be
indented - the first character of these lines must be <code>#</code>). In our example, we
have called the new variable <code>electron_gamma</code>.</p><pre><code>  ! Object representing a particle
  ! If you add or remove from this section then you *must* update the
  ! particle pack and unpack routines
  TYPE particle
    REAL(num), DIMENSION(3) :: part_p
    REAL(num), DIMENSION(c_ndims) :: part_pos
#ifdef EXTENDED_IO 
    REAL(num) :: electron_gamma ! New line, and the surrounding ifdef, endif
#endif
</code></pre><h2 id=welcomef90>Welcome.F90</h2><p>For consistency with the other EPOCH pre-compiler options, we should print a
message when the code has been compiled with our new <code>EXTENDED_IO</code>.</p><p>The first part of the module scans through all possible pre-compiler variables,
and checks if any are present. Add new lines for the new pre-compiler flag.</p><pre><code>#ifdef PHOTONS
    found = .TRUE.
#ifdef TRIDENT_PHOTONS
    found = .TRUE.
#endif
#endif
#ifdef EXTENDED_IO 
    found = .TRUE. ! New line
#endif
</code></pre><p>Next, a message is printed for each present module. Here we have written a
generic message for our extended_io pre-compiler flag.</p><pre><code>#ifdef PHOTONS
    defines = IOR(defines, c_def_photons)
    WRITE(*,*) 'QED Effects -DPHOTONS'
#ifdef TRIDENT_PHOTONS
    defines = IOR(defines, c_def_trident_photons)
    WRITE(*,*) 'Pair production by Trident process -DTRIDENT_PHOTONS'
#endif
#endif
#ifdef EXTENDED_IO
    defines = IOR(defines, c_def_extended_io)                           ! New line
    WRITE(*,*) 'Additional particle variables for output -DEXTENDED_IO' ! New line
#endif
</code></pre><h2 id=partlistf90>Partlist.F90</h2><p>Each MPI rank only tracks particles present within its section of the domain.
As macro-particles move around the simulation, they can pass between cells
controlled by different ranks. When this happens, a new particle is created on
the new rank, its properties are set to match the properties on the old rank,
and the particle on the old rank is destroyed. New particle variables must
also be transferred when particles move between ranks, and this is done here.</p><p>There are 4 steps here:</p><ul><li>Tell the code how many variables are associated with the particle</li><li>Copy the variables on the old rank to an array for transfer</li><li>Set variables on the new rank from the transferred array</li><li>For new particles, initialise the particle variable</li></ul><p>To tell the code how many variables are present, find the <code>set_partlist_size</code>
subroutine. The count of particle variables is stored in the <code>nvar</code> integer.
In this example, we only introduce one more particle variable when the code
is compiled with <code>EXTENDED_IO</code>, so add 1 to <code>nvar</code> if we have compiled with
<code>EXTENEDED_IO</code>:</p><pre><code>#ifdef BREMSSTRAHLUNG
    nvar = nvar+1
#endif
#ifdef EXTENDED_IO 
    nvar = nvar+1 ! New line
#endif
#ifdef PROBE_TIME
    nvar = nvar+1
#endif
</code></pre><p>Next, navigate to <code>pack_particle</code> - the subroutine responsible for collecting
particle variables to transfer to neighbouring ranks. Now we can add our new
variable to the transfer array. Make a note of the position here - variables
must be read in the same order they are stored.</p><pre><code>#ifdef BREMSSTRAHLUNG
    array(cpos) = a_particle%optical_depth_bremsstrahlung
    cpos = cpos+1
#endif
#ifdef EXTENDED_IO
    array(cpos) = a_particle%electron_gamma ! New line
    cpos = cpos+1                           ! Only 1 new variable, so add 1
#endif
#ifdef PROBE_TIME
    array(cpos) = a_particle%probe_time
    cpos = cpos+1
#endif
</code></pre><p>Once the particle variables are packed into an array, this is sent to the
neighbouring ranks. These call <code>unpack_particle</code> to set the properties of new
particles. The syntax for this with our new variable would be:</p><pre><code>#ifdef BREMSSTRAHLUNG
    a_particle%optical_depth_bremsstrahlung = array(cpos)
    cpos = cpos+1
#endif
#ifdef EXTENDED_IO
    a_particle%electron_gamma = array(cpos) ! New line
    cpos = cpos+1  ! Note this is also between optical_depth_bremsstrahlung and probe_time
#endif
#ifdef PROBE_TIME
    a_particle%probe_time = array(cpos)
    cpos = cpos+1
#endif
</code></pre><p>Finally, we must set the initial values for these variables. If we don&rsquo;t do
this, the code can act unpredictably. In the <code>init_particle</code> subroutine, add
the lines:</p><pre><code>#ifdef EXTENDED_IO 
    new_particle%electron_gamma = 0.0_num    ! New line
#endif
#ifdef PROBE_TIME
    new_particle%probe_time = 0.0_num
#endif
</code></pre><h2 id=deck_io_blockf90>Deck_io_block.F90</h2><p>Unless you want to make a new physics package, a new particle variable is only
useful if you can output it. This is done using the standard EPOCH output block.
Recall we&rsquo;ve already defined a <code>c_dump_qed_el_gamma</code> flag - now we just need
to tell EPOCH how it will appear in the input deck.</p><p>Navigate to <code>io_block_handle_element</code>, find the <code>str_cmp</code> lines which interpret
the the deck lines, and add:</p><pre><code>#ifdef BREMSSTRAHLUNG
    ELSE IF (str_cmp(element, 'bremsstrahlung_optical_depth')) THEN
      elementselected = c_dump_part_opdepth_brem
#endif

#ifdef EXTENDED_IO
    ELSE IF (str_cmp(element, 'electron_gamma')) THEN  ! New line
      elementselected = c_dump_qed_el_gamma            ! New line
#endif
</code></pre><p>Whatever you write as the second argument to <code>str_cmp</code> is how you will
have to write the variable in the EPOCH output block. As we are keeping things
simple in this example, we will not bother with restart dumps. The value of
<code>electron_gamma</code> will not be re-loaded when you restart the code from a
restart dump.</p><h2 id=diagnosticsf90>Diagnostics.F90</h2><p>At this point we have declared a new particle variable, wrapped it in
pre-compiler flags, made it visible to MPI routines, and told EPOCH it can be
dumped. Now we actually have to write the variable to file.</p><p>There is a section in the <code>output_routines</code> subroutine which contains lines
with <code>write_particle_variable</code> calls. Add a new one for our variable:</p><pre><code>#ifdef BREMSSTRAHLUNG
        CALL write_particle_variable(c_dump_part_opdepth_brem, code, &amp;
            'Bremsstrahlung Depth', '', it_output_real)
#endif
#ifdef EXTENDED_IO
        CALL write_particle_variable(c_dump_qed_el_gamma, code, &amp;
            'Emitting Electron Gamma', '', it_output_real)
#endif
</code></pre><p>The <code>'Emitting Electron Gamma'</code> string controls how the variable will be
labelled in the SDF file.</p><h2 id=iteratorsf90>Iterators.F90</h2><p>One of the arguments of the <code>write_particle_variable</code> subroutine is a call to
the <code>it_output_real</code> function. We need to modify this function to give our new
variable, when requested. To do this, add the following case to the
<code>it_output_real</code> function:</p><pre><code>#ifdef EXTENDED_IO
      CASE (c_dump_qed_el_gamma)
        DO WHILE (ASSOCIATED(cur) .AND. (part_count &lt; npoint_it))
          part_count = part_count + 1
          array(part_count) = cur%electron_gamma
          cur =&gt; cur%next
        END DO
#endif
</code></pre><h2 id=setting-your-variable>Setting your variable</h2><p>All the previous steps are required whatever your particle
variable is. All we need to do now is figure out how to set it. This may be
straightforward or complicated, depending on what the variable is. We can&rsquo;t
cover every possible particle variable here, but you may find it useful if we
finish our example, to see how one would go about it.</p><p>Here, we want to save the electron gamma factor when a photon has been emitted.
Photon emission occurs in the <code>generate_photon</code> subroutine of <code>photons.F90</code>.
When in this subroutine, the generating electron information can be accessed
through the <code>generating_electron</code> particle pointer. Fortunately for us, the
electron $\gamma$ factor has already been calculated in this subroutine, and is
given by <code>generating_gamma</code>. Let us set our new particle variable to this
value, as soon as the photon macro-particle has been created.</p><pre><code>      CALL create_particle(new_photon)
      new_photon%part_pos = generating_electron%part_pos

#ifdef EXTENDED_IO 
      new_photon%electron_gamma = generating_gamma     ! New line
#endif
</code></pre><h2 id=testing>Testing</h2><p>If all has gone well, we have a new particle variable ready for printing.
Compile EPOCH (you may need to run <code>make clean</code> first if you have changed the
pre-compiler flags).</p><p>It&rsquo;s best to run with a small input deck for code testing. We have shrank the
qed_rese.deck found in the source code, such that it can run in a few seconds.
This tiny deck has been included at the end of this section.</p><p>When running, the code correctly generates the compiler-flag messages:</p><pre><code> Welcome to EPOCH2D version 4.19.1   (commit v4.19.1-7-g6a1bfa99-dirty)

 The code was compiled with the following compile time options
 *************************************************************
 QED Effects -DPHOTONS
 Additional particle variables for output -DEXTENDED_IO
 *************************************************************
</code></pre><p>When we inspect <code>0001.sdf</code>, we find that 21798 macro-photons have been created,
and all of them have an emitting electron gamma value. These range from 20 to
1896 in this example. The input deck used for this example is given below. A
new particle variable has been successfully created!</p><pre><code>begin:control
  nx = 50 # in x
  ny = 50
  nparticles = nx * ny * 2
  t_end = 100e-15
  x_min = 0
  x_max = 50 * 10.0e-9
  y_min = 0
  y_max = 50 * 10.0e-9
  dt_multiplier = 0.8
end:control

begin:qed
  use_qed = T 
  qed_start_time = 0 
  produce_photons = T
  photon_energy_min = 50 * kev 
  produce_pairs = F 
  photon_dynamics = F 
end:qed

begin:boundaries
  bc_x_min = simple_laser
  bc_x_max = reflect
  bc_y_max = reflect
  bc_y_min = reflect
end:boundaries

begin:species
  name = Electron
  fraction = 0.5
  dump = T
  temperature = 0
  number_density = if (x gt 0.1*x_max, 1.0e20, 0)
  identify:electron
end:species

begin:species
  name = Ion
  fraction = 0.5
  dump = T
  number_density = number_density(Electron)
  temperature = 0
  identify:proton
end:species

begin:species
  name = Photon
  frac = 0
  dump = T
  identify:photon
end:species

begin:output
  dt_snapshot = t_end
  electron_gamma = always
end:output

begin:laser
  boundary = x_min
  intensity = 1.0e21 * 1.0e4
  lambda = 1.0e-6
  polarisation = 0.0
  phase = 0.0
  t_profile = 1
  profile = 1
end:laser
</code></pre></div><div class=article-widget><div class=post-nav><div class=post-nav-item><div class=meta-nav>Previous</div><a href=/developer/extensions/new_modules.html rel=next>New Module</a></div></div></div></div><div class=body-footer><p>Last updated on Apr 24, 2023</p></div></article><footer class=site-footer><p class=powered-by>Powered by the
<a href=https://sourcethemes.com/academic/ target=_blank rel=noopener>Academic theme</a> for
<a href=https://gohugo.io target=_blank rel=noopener>Hugo</a>.</p></footer></main></div></div><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js integrity="sha256-eOgo0OtLL4cdq7RdwRUiGKLX9XsIJ7nGhWEKbohmVAQ=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/r.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.js integrity="sha256-EErZamuLefUnbMBQbsEqu1USa+btR2oIlCpBJbyD4/g=" crossorigin=anonymous></script><script>const code_highlighting=!0</script><script>const isSiteThemeDark=!1</script><script>const search_config={indexURI:"/index.json",minLength:1,threshold:.3},i18n={no_results:"No results found",placeholder:"Search...",results:"results found"},content_type={post:"Posts",project:"Projects",publication:"Publications",talk:"Talks"}</script><script src=https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.1.1/anchor.min.js integrity="sha256-pB/deHc9CGfFpJRjC43imB29Rse8tak+5eXqntO94ck=" crossorigin=anonymous></script><script>anchors.add()</script><script id=search-hit-fuse-template type=text/x-template>
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script><script src=https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin=anonymous></script><script src=/js/academic.min.6f1005d1a84220e2f466ff3d8e712f31.js></script><div id=modal class="modal fade" role=dialog><div class=modal-dialog><div class=modal-content><div class=modal-header><h5 class=modal-title>Cite</h5><button type=button class=close data-dismiss=modal aria-label=Close>
<span aria-hidden=true>&#215;</span></button></div><div class=modal-body><pre><code class="tex hljs"></code></pre></div><div class=modal-footer><a class="btn btn-outline-primary my-1 js-copy-cite" href=# target=_blank><i class="fas fa-copy"></i> Copy</a>
<a class="btn btn-outline-primary my-1 js-download-cite" href=# target=_blank><i class="fas fa-download"></i> Download</a><div id=modal-error></div></div></div></div></div></body></html>